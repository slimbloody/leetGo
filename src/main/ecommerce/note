对电商公司来讲，最核心最难做的有三部分：商品、订单、库存
商品与店铺、营销、评价等相关
订单与会员、营销、支付、库存、物流等相关
库存与订单、采购、WMS、营销等相关

（1）商品中心：主要管理SKU（最小库存单位）、SPU（标准化产
品单元）、属性（关键属性、非关键属性、销售属性）、类目品牌、价
格等有关商品的数据。
（2）订单中心：管理订单类型、订单状态，收集关于商品、优
惠、用户、收货信息、支付信息等一系列的订单实时数据，进行库存更
新、订单下发等一系列动作。
（3）支付中心：管理支付数据，调用第三方支付平台接口，记录
支付信息（对应订单号、支付金额等），支付对账。
（4）会员中心：主要管理用户等级、用户权益、积分、卡券等会
员相关信息，通过一系列满足用户心理、提高黏性的方法来实现开发新
用户、增加用户活跃度的目的。
（5）调度中心：将订单信息转化为发货通知单，以及其他出入库
单，调度仓库和物流进行发货。
（6）促销中心：主要管理活动相关，优惠券、满减、专场活动、
促销专区等。促销工具的开发对电商尤其重要。促销活动的滥用易造成
的用户疲劳，怎样推陈出新，给产品经理造成了很大挑战。
（7）内容管理系统：主要是对用户端进行页面配置（Banner、
ICON、Tab），配置首页，自定义活动页面，设置生效时效。
（8）评价中心：管理商品评价和用户反馈。这并没有想象的那么
简单，涉及一些敏感词和敏感图片的筛选，以及回复内容管理。
（9）采购中心：管理SKU，当库存预警时，及时生成采购单进行
入库。有供应商管理模块，主要进行供应商管理评级，发展新供应商等
功能。
（10）财务管理：主要管理订单、采购系统相关的财务数据，数据
准确性要求较高。还需要负责对账、清账、统计等业务。
（11）WMS系统（仓库管理系统）：主要包括入库、出库、盘点
等模块。WMS主要和调度中心进行数据交互，反馈出入库状态和库存
变动。
（12）物流中心：主要包括运费模板，负责运费管理（前端订单、
真实物流成本）、物流状态保存查询（包括快递100、菜鸟等关联业
务）。如果是跨境电商，还涉及和海关总署的对接，进行报关操作。
（13）风控中心：主要利用大数据进行用户信用建设、反欺诈，避
免恶意评价、刷单退款等操作，构建安全的电商购物环境。
（14）客服中心：主要管理退货退款、售后服务等操作，包括呼叫
中心、在线客服等，与之对应的是工单系统，将客服任务进行队列管
理，分配给相应的客服。
（15）店铺管理：功能庞杂，相当于提供给B端用户一个Saas管理
后台，提供管理商品、营销、订单一系列功能，主要针对一些有对B端
业务的电商开放平台。


如图2-4所示，以商品模块为例，在业务量逐步增长时，为了高效便
捷地服务用户，会慢慢拆分多个模块。如图上所示，在系统上线初期，
整个后台系统融合在一起，商品部分只是后台系统的一个模块。随着业
务量的增长，将商品中心独立为子系统；接着随着业务继续增长，库存
模块从商品中心中独立出来，单独成为库存中心；再接着发展下来，价
格模块从商品中心独立成价格系统；再后来，价格系统根据需要拆分为
价格管理系统与价格监控系统。从这个例子中我们可以看到，系统都是
从简单到复杂，随着业务慢慢迭代。

==============
3. 商品中心
==============
笔者主要从9个方面来阐述商品中心：
商品的基本概念、类目和品牌管理、属性管理、SKU编辑、商品编辑、
商品管理、商品搜索及筛选、商品推荐、商品评论等。

随着商业模式的变化，商品中心的架构亦会随之变动，例如商品分
为实物商品或虚拟商品，商品归属分自营或平台商家，售卖分为正常售
卖和预售。不同业务场景下商品中心的设计会有些不同。虽然本文讲的
主要是类似B2C模式的商品中心的设计，但是万变不离其宗，只要善于
思考，结合业务场景，举一反三，都能够找到最合适的解决方案。


类目：即分类树。电商常用的有两层类目：前台展示类目和后端商品类目
前台类目指的是展示给消费者看的类目，会根据季节、销售策略、活动进行变动
后台类目属于基础数据，不可随意变动，添加SKU时都需要选择后台类目，进行绑定

属性: 分为关键属性、销售属性、非关键属性
关键属性是指能够唯一确定产品的属性，是必填项，例如手机的屏幕尺寸、型号属于关键属性。
销售属性是组成SKU的特殊属性，或称为“规格属性”，例如手机的“颜色”、“内存”。
非关键属性指的是除关键属性、销售属性外的其他属性，如手机的手机接口类型。非关键属性不一定是非必填项，不过有时为了商品信息完整，也会设为必填项。

（4）商品属性：表示商品的特有特征，比如新旧程度、保修方式等，不能作为产品的属性

=============
3.1 类目
=============
那为什么要将前、后台类目分开管理，而不是前、后台共用一套类目呢？
这就是业务驱动产品的一个实例。随着商品量的增多（京东的SKU
达到数百万级，淘宝、天猫的SKU达到数亿级）、类目树的层级越来越
深，一方面，如果买家直接使用后台类目，那么查找商品时将越来越
难，另一方面，出于日常运营需要，运营人员在调整类目时，都需要去
变更商品的类目，工作量巨大，而且随着节日、时令季节变化，运营会
经常变更类目。

在这样的情况下，将前、后台类目分离。后台类目面向商家或供应
链人员，商品属性、销售属性及品牌等很多数据都是在基础类目上进行
管理；前台类目面向用户，方便用户查找商品，还可以随着运营需要去
调整。前、后台类目通过映射关联。

后台类目相对固定，确定了之后不会轻易变更或删除，如果类目下挂载有商品，就不能删除或作废。
类目树的层次不能太深，一般三层或四层。如果太深，不论对于管理还是技术性能来说，都是不利的。
类目树中最后一层类目称为叶子类目，商品必须挂载于叶子类目下。

商品属性、销售属性及品牌等很多数据都是在基础类目上进行管
理。发布商品时，在选择好叶子类目之后，会被要求选择品牌、填写相
应的属性，所以类目管理属于较为核心的工作，一定要从长远角度考
虑。

赠品作为促销（低价）商品，应该专门设置类目，通常放置到商品
发布类目“其他—赠品”类目下，以避免引起买家对该商品的误解，进而
避免产生不必要的纠纷。

前台类目不同于固定的后台类目，编辑很灵活、可重叠、可删除、可随时变动，定时生效。




如图3-5所示，在定义一个属性时，需要挂载在类目下，区分属性分
类（关键属性、销售属性、非关键属性、商品属性），并确定属性值、
显示类型（单选、多选、可自定义）、是否必填以及属性分组。对属性
的定义是为了在添加商品时，属性列有判断条件。在搜索筛选时，确定
各属性字段的意义和权重。

1．属性分组
由于一个类目的属性有时会很多，可能几十个，甚至上百个，所以
引入了属性分组的概念，把形容某一类特征的几个属性归属于一个组，
这样在前端的规格参数里可以按后台设置的属性分组按序展示，也方便
对属性进行管理。如图3-6所示，屏幕参数、镜头参数、曝光控制、闪光
灯参数等都属于属性分组。

2．属性继承
如果网站的商品分类为三个层级，每个商品由很多的商品属性构
成，其中同一层级的商品属性可能有很多都是相同的属性，为了减少属
性添加时的工作量，我们将这部分共用的属性归类后赋值在上一层级的
分类中，依次操作，将归类后的属性分别赋值给上级的分类中。
每一个层级的商品属性继承上一层级的商品属性，将每个层级的属
性提取出来，便组成了一个商品的完整的属性表达。

，1级类目有属性A，2级类目有属性B，3级类目有属性C，那3级类目下的商品SKU1就具有属性A、B、C。

============
3.4 spu sku
============
还有一个比较特殊的概念：组合SKU，主要是解决出售组合商品的
问题。组合SKU的属性都继承主SKU。组合SKU不同于套装促销。套装
促销在订单中会展示多个商品，而组合SKU在前台是一个商品。组合
SKU的应用场景主要是添加赠品、组合售卖，与前台的商品套餐有所区
别。在订单解析成发货单时，组合SKU需解析成单一SKU，方便仓库发
货，更新库存。


69条码是一种俗称，是指我国的商品条码。由于我国的商品编码开头我69，所以也称69条码。

商品条码是ANCC系统的一个重要组成部分，是ANCC系统发展的基础。它主要用于对零售商品、 非零售商品及物流单元的条码标识。

在仓库的条码方案以下有两种。
1. 全部自建条码。采用自己的SKU编码管理商品，需要入库前重新贴标，成本较高。
2. 有69码的商品沿用69码，无69码的商品（比如蔬菜、生鲜等）以及无法指定到单一的有码商品重新贴SKU编码。在仓库管理时做相应的条码映射。



很多电商公司业务定位都是B2B2C，为了扩充SKU，增加用户量， 或者构建平台体系，都会允许第三方来平台管理商品，
SKU需要增加所属商家，商品详情、属性值、库存都需要相互独立，在SKU、SPU纬度上增加一个商家纬度。







货号即商品编码，在商城购物时会扫描
的条形码就是货号。货号不等同于SKU编码，同一商品编码的商品可能
是不同SKU，有着不同的规格，所以不能直接拿货号来管理SKU。





货号即商品编码，在商城购物时会扫描的条形码就是货号。货号不等同于SKU编码，同一商品编码的商品可能是不同SKU，有着不同的规格，所以不能直接拿货号来管理SKU。







==================
3.7 商品搜索及筛选
==================
另外搜索过程也存在纠错，主要有拼音纠错、错别字纠错等，如图
3-16所示，当搜索“nuojiya”时，会显示“诺基亚”相关商品。纠错主要通
过建立错词与正确词的映射关系表，在搜索的时候替换。数据来源主要
有用户搜索词、搜索日志、运营部门人工更新等


==================
3.8 商品推荐
==================
内容电商，通过社区做内容来提高转化率

近两年崛起的内容电商也属于商品推荐的一种，很多平台都开始在
内容上发力，越来越多的消费者在看直播、看自媒体文章、看帖子的过
程中购买商品。例如淘宝的微淘、京东的觅生活（Meelife）、小红书
等。

在移动互联网形态下，用户目的性较强的商品浏览逐渐减少，更倾
向于活动推荐或个性化推荐。但简单的商品列表和标语描述的冲击力已
然不够，内容电商将商品嵌入到文案或者视频中，通过详细的描述消费
感受和商品特点，激起用户的同理心，这样的购物消费更容易产生冲动
性消费，而非计划性消费。



完善的推荐系统一般由四部分组成，按照“采集”、“分析”、“推
荐”的步骤，分为四大模块：采集用户信息的用户行为记录模块、分析
用户喜好的用户行为分析模块、分析商品特征的商品分析模块，以及推
荐算法模块。用户行为记录模块负责采集能反映用户喜好的行为，例如
浏览、购买、评论、问答等；用户行为分析模块通过用户的行为记录，
分析用户对商品的潜在喜好及喜欢程度，建立用户偏好模型；商品分析
模块主要对商品进行商品相似度、商品搭配度、目标用户标签进行分
析；推荐算法根据一定的规则从备选商品集合中筛选出目标用户最可能
感兴趣的商品进行推荐。

用户画像是根据用户特征（性别、年纪、地域等）、消费行为习惯
（浏览、购买、评论、问答等）等信息进行抽象化，建立标签化的用户
模型。构建用户画像的核心工作即是给用户“贴”标签，而标签是通过对
用户行为记录分析而来的高度精炼的特征标识。推荐系统的难点，其中
很大一部分就在于用户画像的积累过程极其艰难。用户画像与业务本身
密切相关。在用户标签足够丰富并且多的时候，就可以对用户聚类，例
如用“A/B/C/D等”几种典型用户画像来代表商城的目标用户，还可以将
新用户进行归类这些典型用户画像中。

商品分析模块主要根据商品的类目品牌、商品属性、产品评论、库
存、销售记录、订单数据、浏览收藏、价格等数据来分析商品相似度、
商品搭配度（可人工调整），并且对商品贴上目标用户标签。
用户画像、商品分析模块的数据都是为推荐算法提供基础数据。商
品推荐的算法有很多种，需要根据推荐结果反馈，不断优化模型。有时
候还需要考虑人工因素的权重，例如自营商品排在前面、评分高的店铺
优先推荐等。在推荐商品时，还有一些特殊推荐：“购买此商品的顾客
也同时购买”、“看过此商品后顾客购买的其他商品”、“经常一起购买的
商品”，都是基于商品进行的推荐。

需要注意的是，如果完全按照用户行为数据进行推荐，就会使得推
荐结果的候选集永远只在一个比较小的范围内，所以在保证推荐结果相
对准确的前提下，应按照一定的策略，去逐渐拓宽推荐结果的范围，给
予推荐结果一定的多样性。

在大数据时代，商品推荐模块虽然在一定程度上进行了精准营销，
以提高商品转化率，但是与推荐的准确性有些相悖的，是推荐的多样
性。有时候会出现推荐混乱的情况，并且引起用户反感。例如某用户曾
经浏览过某款电视，结果后台系统连续一个月都给该用户推荐这款电
视；甚至更糟的是，在某用户购买过手机之后，后台系统还不断向该用
户推荐其他手机。出现这种问题，主要是因为推荐算法做得不够到位。
在很多用户行为数据没有收集处理、商品关联度没做好的情况下就盲目
推荐商品。
==================
3.9 商品评价
==================
商品评价在电商系统中是很常见的模块。对用户来说，可以把用户
在购买后对商品、服务、物流等相关信息的感受写出来，为其他用户提
供购买决策，减少购物成本。对平台来说，有质量的评价有助于降低退
货率，提高优质商品的转化率，并且构建商家信用评价体系，合理分配
平台资源，甚至帮助优化搜索。


===============
4.1 促销的目的
===============
促销活动有很多现实价值。
（1）拉新。促销活动可以带来新用户，尤其是用户较少的新平
台、新店铺，通过这种方式来吸引用户。
（2）去库存。通过活动可以清理库存，降低库存占用成本。
（3）扩大品牌知名度。结合广告做促销能够扩大品牌知名度。
（4）推新品爆品。很多商家大力做活动来推新品或者爆品，增加
店铺流量，同时也能给其他商品带来曝光的机会。
（5）与其他平台竞争。现在有许多人造购物节，例如双11、618，
许多电商平台或商家，主动或被动都要参加促销活动。
（6）提高客单价、客单量。在优惠券、满减满赠等活动的催化
下，用户不自主地都会去凑单购买，增加购买金额，同时产生许多额外
的购买行为。



客单价（ATV: average transaction value）
指商场（超市）每一个顾客平均购买商品的金额，客单价也即是平均交易金额
客单量 即商场或超市平均每个客户购买货品的数量



（1）满减促销：购物者只要购买相应商品到规定价格即可得到一
定的减价优惠。主要有两种形式：阶梯满减和每满减。阶梯满减，例如
满100减10、满300减50、满500减80等；每满减，指订单金额每满规定
金额就减免一定金额，比如设置每满100减10，那么订单金额230元就实
付210元。
（2）单品促销：在特定时间内购买指定商品享受一定的价格优
惠。例如促销期间商品6折，那么原价100元的商品，购买时就60元。
（3）套装促销：商品组合套装以优惠价出售。例如A商品50元，B
商品80元，而A和B两种商品的套装促销价100元。
（4）赠品促销：购买主商品之后赠送商品（可多个赠品）。
（5）满赠促销：购买商品金额满X元后送某商品，或者购买商品金
额满X元后再加价Y元送某商品。这种形式与赠品促销的区别在于该形
式以相应商品订单的价格来区分，可分阶设置，例如满300元送自拍
杆，满500送充电宝，满1000送高端耳机等。
（6）多买优惠促销：有“M元任选N件”、“M件N折”两种优惠形
式。这个主要是参考一些线下卖场发展的促销形式。
（7）定金促销
定金促销有定金预购和定金杠杆两种常见的模式。定金预购指全款
缴纳定金，交了定金相当于就已经确认订单支付完成，只要商品到货就
可以直接发货；定金杠杆，指预售期交付一定金额的定金可以折抵更多
金额，例如定金10元可抵扣30元，当商品正式卖的时候恢复正常价格，
而交过定金的补齐尾款就行。
定金促销的方式和其他促销方式区别很大。首先在库存上，参与定
金预售的商品时单独分配活动库存，不会占用总库存，待商品到位后才
会正式扣减真实库存，再往下流转至仓库；其次在订单上，定金杠杆这
种类型将订单的支付确认分成了两步，从定金到尾款，在商品正式售卖
时，应提醒用户继续支付，完成订单支付。
先接龙后支付




【优惠券的类型和应用场景】
优惠券有多种分类方式，按照使用门槛、使用范围、发放主体等有
不同的分类。
（1）按照使用门槛分为现金券、满减券、折扣券。
现金券：不限制订单金额，可以直接使用。
满减券：订单金额需要满足一定的最低额度才可使用，例如满100
减10元优惠券。
折扣券：使用折扣券在购买相应的商品时可打折。
（2）按照适用范围分为：单品券、品类券、品牌券。
单品券：购买优惠券指定商品时可使用，这种优惠券一般只针对少量特殊商品可以使用。
品类券：购买优惠券指定类别的商品即可使用，除个别特殊商品。
品牌券：购买优惠券指定品牌的商品时可使用，除个别特殊商品。
一般按照品牌或者品类设置优惠券范围是比较常见的方式。
（3）按照发放的主体分为平台优惠券和店铺优惠券
平台优惠券：优惠券由平台发放，可以跨店使用。比如平台活动优
惠券、平台注册的新人优惠券、平台积分兑换的优惠券。
店铺优惠券：在平台上的店铺自己发放的优惠券，比如淘宝（或天
猫）上的店铺优惠券、京东的店铺优惠券。
平台优惠券的成本由平台和店铺共同承担，在店铺使用时优惠金额
由平台返给店铺；店铺优惠券的成本则由店铺自己承担。



1．生成优惠券
在生成优惠券时，主要是从优惠券信息和推广信息两方面来考虑优
惠券的设计。
（1）优惠券信息。需要考虑：优惠券名称、类型（现金券、满减
券、折扣券等）、面值、使用条件（比如满X元可用）、使用平台（客
户端、H5商城、主站、各分销渠道等）、有效期时间（绝对时间——具
体某时间段、相对时间——领取之日后多少天有效）、发行量（优惠券
张数）、使用范围（平台券——全平台通用、店铺券——仅在某店铺可
用）、商品范围（全品类、限制品类、限制商品，设置优惠券适用的商
品）。
（2）推广信息。需要考虑：发放方式（可发放可领取、仅可发放
——只能由平台发放给用户、仅可领取——只能用户自己领取或兑
换）、推广范围（免费领取、积分兑换）、优惠券是否公开（设置公开
后，在领券专区、商品详情页、购物车都默认展示）、限领（每人仅限
一张、每人每天限领一张等）、券领取时间（设置领取时间段）。

2．发送优惠券
优惠券有主动领取和被动领取两种方式。
（1）主动领取。用户在看到优惠券后主动进行领取。一般来说，
用户看到优惠券的场景主要包括以下几种：在店铺首页或者平台上看到
优惠券；用户在线下看到宣传推广的优惠券；用户在朋友圈看到优惠券
分享链接等。
让用户主动领取优惠券的发放方式需要一定的运营成本，需要打动
用户，让其产生兴趣主动领取。另外，这种方式需要做好防作弊机制，
防止用户与商户恶意套取优惠券。
（2）被动领取。系统主动给用户发送相应的优惠券，但是这种大
面积分发的方式，用户精准度低，转化率也低，促进客单量少。
系统发放优惠券的场景有很多种：比如用户注册、大促活动、客服
发券——主要是售后补偿（平台责任导致售后，发券补偿客户），以及
好评返现。
除了以上的方式，许多平台电商还有一项业务：大客户团购，主要
是给一些特定单位提供的福利卡，本质上也相当于给用户发优惠券，例
如京东卡。这种福利卡可以通过优惠券（平台币）的形式实现，生成相
应的卡密（或兑换码），制作实物卡售卖给一些单位发福利、送礼。用
户输入卡密兑换之后，兑换成平台的交易币（相当于给购物卡充值），
可以用来抵扣订单金额。


3．优惠券核销
在用户下单时，需要系统从用户账户中的优惠券选择合适的优惠券
推荐给其使用的。推荐算法一般分为以下三步。
（1）从用户优惠券列表中选择出当前订单可用的优惠券（包括通
用券和相应产品优惠券），主要是从有效期、商品范围等条件判断。
（2）若有多种可用优惠券，但是金额不同，默认选择可抵扣最高
的优惠券。
（3）如果金额相同，先匹配同类优惠券的优惠券，但当优惠券的
额度（现金券）大于支付额度弹出提醒框，确认是否使用。
注意，在用户的优惠券列表中，优惠券是否失效也是实时拉取的
（失效时间过久应清除此优惠券），下单时优惠券选择应仅显示当前订
单可用的优惠券。



优惠券在订单中的处理
1. 统一设置成不可返还，用了之后就不退。
2. 订单中全部退款时，优惠券全部退还。
3. 订单中部分退款时，普通优惠券不返还。



拼团模式的应用场景主要有两种。
一类是专门做拼团模式的电商， 如拼多多、萌店等，前期通过一些优质低价的拼团在外部社交网络中分
享，大量积累客户，后期主要以特卖电商的形式在站内运营，注重订单量，
具体表现为前期多是10人团、20人团等多人团，后期多是2人团、5
人团，并且可以站内参团。另一类就是普通电商平台，拼团主要是为了
拉新、打造爆款用，适合中小型电商公司。
类似淘宝、天猫、京东等大型电商平台很少做拼团，主要是秒杀限时抢购。


拼团主要有几种类型：新人团、普通团、超级团。
（1）新人团主要限定新用户（未下过单）参加，可以由老用户开
团，这一类型的团购主要是为了拉新。在参团时要校验是否新用户。
（2）普通团就是最常见的拼团团购，例如2人团、5人团等，任意
用户都可以参加。
（3）超级团是指需要较多的人参与才能成团，根据成团人数来制
定阶梯价格，一般为50～200人团。例如商品A原价100元，50人团则售
价80元，100人团则售价70元，200人团则售价60元。在有效时间内达到
规定的参团人数，就组团成功，人数不足自动退款。



拼团业务流程
（1）不论是通过好友的分享还是直接在商城中选择商品后，用户
选择开团或参团的同时判断是否有库存，然后提交订单。
（2）提交订单后，在支付的时候会判断此拼团是否满团。未满团
则继续支付；已满团会提醒用户去开团，或者自动帮用户开团，走到支
付环节。
（3）支付成功，用户参团成功。在规定时间内，参团人数达到规
定数就判定拼团成功。超过规定时间未成团就判定拼团失败。
（4）拼团成功的订单变更为待发货，开始向仓库流转；拼团失败
的订单取消订单，原路退款。


（1）一般采用付款成功才能参团成功的流程。先成团后付款的流
程，由于打断了用户整体操作流程，影响用户体验，很容易导致用户更
多放弃支付。
（2）订单提交成功后，订单流转为待付款状态。规定时间内（如
10～30分钟）不支付，订单会自动取消，拼团失败；待付款订单，用户
也可手动取消订单。
（3）在支付时再次去判断是否满团，是为了避免“超团”，比如原
定是2人团，结果最后有3人参团成功。
（4）拼团成功或拼团失败，都要以一定的方式（短信或APP提醒）
通知用户。
（5）拼团整体的活动设置一个限定时间，每个用户团设置限定时
间，例如A商品参与拼团是10天，但是需要用户开团之后24小时内完成
拼团。
（6）拼团的库存管理比较特殊，后面会详述



【拼团的库存管理】
关于拼团库存扣减，有如下两种方案
（1）参团支付之后扣减库存
这种方案会占用实际库存，未成团的那部分库存就无法出货，造成
浪费。
例如：A商品有100件，参加10人团，最初开团20个。最终100人参
团成功，但是只有5个团成功拼团，所以发货50件，其他50人退款。
（2）拼团成功之后再扣减库存
这种方案无法管控成团数量，库存用完之后，后续拼团成功的就会
超卖，发生退款，影响用户体验。可以改进的是，在拼团支付的时候，
要判断当前是否有剩余库存（用总库存减去已成团数量），若判断没有
剩余库存，则不允许参团或开团，也不允许支付。
例如：A商品有100件，参加10人团，最初开团30个。最终200人参
团成功，前10个团成功拼团，发货100件，其余100人退款。
两种库存扣减方案都是可行的，但都有一定的缺陷，大部分电商采
用的是第二种方案，这样更多是为了拉新，或让更多用户参与。为了避
免超卖，可预留一小部分库存，来应对超出的情况。


===================
6. 库存管理
===================
本章的重点内容如下。
（1）电商库存体系分为三层：销售层、调度层、仓库层。
（2）库存的变动又分为自上而下、自下而上两种。
（3）每一层库存数量的变化可总结为增加、锁定、解锁、扣减、
返还等。
库存数据的变动都需要有相关单据依据，例如销售订单、发货单、
采购入库单等。




（1）增加：自有仓库通过采购入库，协同仓库通过代销采购协议
入库；
（2）锁定：下单之后锁定库存。
（3）解锁：订单取消之后释放锁定库存。
（4）扣减：订单支付成功之后扣减库存，扣减锁定库存。
（5）返还：退货、换货后返还库存，相当于增加库存。
（6）异常处理：库存数据在定期校验时，如果出现异常数据，就需要进行异常处理（自动或人工处理）



电商中的库存管理是为了保证前台商品的正常售卖，库存的管理和仓库密不可分，而仓库又和销售、采购相关，

主要有销售订单、采购、仓间调拨、盘盈盘亏、预售、售后退货等因素

库存分层：销售层、调度层、仓库层





1．销售层
这一层主要面对前端用户。一般情况下，前端库存要和实物库存保
持一致，即不能超卖。但是做预售时，就是虚拟库存，下单时涉及的库
存动作只在销售层，待到备货之后，再推送至调度层。
销售层的库存决定是否可售卖，下单是否能成功。在秒杀时，活动
库存决定了是否可以秒杀成功；在预售时，预售库存决定是否可下定金
预定。
（1）可销售库存：网站前台显示的库存，也就是可以对外售卖的
库存。当“可销售库存＞0”时，前台网站则会显示商品可销售；而当“可
销售库存＝0”时，前台网站则会显示商品缺货。
（2）锁定库存：用户下单锁定库存，支付后扣减库存。锁定库存
指的下单时占用库存，保证客户下单后支付的订单都是有货可发，而不
会相互冲突。
（3）已销售库存：统计商品已售数量。当支付成功，商品就算作
已销售库存。如果取消订单或售后就需要走相应的库存变动流程变动。
（4）活动库存：主要是做促销活动（例如秒杀）时，分配固定数
量的商品给相应的活动，这时候就需要从可销售库存中占用相应数量给
活动库存。这部分库存也是走相应的锁定、扣减逻辑。
（5）预售库存：这部分是虚拟库存，主要是拉动需求，例如B端订
货、双11定金预售等。预售同样走相应的锁定、扣减逻辑。不同的是，
预售的订单需要备货之后，再推送至调度层。


2．调度层
调度层相当于订单的分配中心，将订单转化为发货单，按照调度规
则决定哪些SKU由哪个仓库发货。
调度层的库存分为单仓、区域、总库存三个维度，区域库存指的是
这些仓库只发某一区域的，例如华中地区的仓库只配送华中地区，北京
就无法从华中地区的仓库发货。总库存即所有仓库的SKU库存总计。
（1）账面库存：仓库中的实物库存，只要是未出库的都算在账面
库存中。
（2）可用库存：仓库中可供发货的库存。这部分库存是可供调度
的库存。
（3）在途库存：下了采购单但是尚未入库的库存，在途库存理论
上部分是可供销售的，例如“T＋1”的在途库存，就是指1日之后就可以
入库的SKU。
（4）不可销售库存：仓库盘损的库存，通常是仓库中的不良品，
是无法售卖的库存。这部分库存需要通过特定途径处理
（5）已用库存：在调度层已分配的库存。


3．仓库层
仓库层的库存对应的是实物库存，出库入库盘点都会引起仓库库存
的变动。
（1）可用库存：发货单推至仓库后，仓库可以用于发货的库存，
不包括锁定的库存。
（2）锁定库存：发货单推送至仓库后锁定库存，锁定时同时去锁
定库位库存。
（3）已出库库存：已经确认出库的实物库存。
（4）不可用库存：盘点时发现的不良品，需要报损，从可用库存
转化为不可用库存。
库位的概念。仓库中的库存是由库位库存组成的，库位上分为可用
库存、锁定库存两种。由于WMS中的库存逻辑较为复杂，这里不做详
细论述。



【库存同步】
由于触发库存发生变动的点不一样，库存的变动有两种流向。第一
种是自上而下（从销售层到调度层，再到仓库层）；第二种是自下而上
（从仓库层到调度层，再到销售层）两种。
（1）自上而下：用户下单后，首先会生成订单，扣减销售层的库
存；然后流转到调度层进行调度，生成发货通知单，调整调度层的库
存；最后推送至仓库，WMS系统同步响应，扣减库存并进行出库。
（2）自下而上：仓库的实物入库可以算是从下到上引起的库存变
动。主要有三种单据：采购入库单、退货入库单、调拨入库单。实物入
库，会连锁引起仓库层、调度层、销售层的可用库存逐步增加。


==================
6.3 库存调度逻辑
==================


==================
6.4 库存控制策略
==================
需求预测是有效控制库存系统的关键。需求有五个方面的因素必须
要考虑，即数量、时间、频率、范围以及可预测性。


==================
7.1 物流服务概述
==================
（1）普通物流：电商的基础服务设施，使商业跨越了空间的阻
碍，也是绝大部分人的日常生活必备。四通一达、顺丰等都是因电商而
兴起的快递公司。
（2）同城配送：近年较火的物流概念，主要解决对物流效率要求
较高的需求。同城配送主要因为外卖而兴起，成本高于普通快递。
（3）门店自提：在日常生活中较为常见，但目前还没有和电商完
美地融合到一起。可以预见的是，门店自提将会是”新零售时代”的重要
物流方案。

【普通物流】
物流是个大概念，只要涉及实物运输都属于物流的范畴。在一般的
电商企业中，日常主要业务是零担物流，很少有整车物流。下文为了区
分描述，将从事小件运输的公司称作快递公司，比如“四通一达”；将大
件运输的公司称作大件物流公司，比如德邦物流、佳吉、天地华宇等。

【门店自提】
线上下单，门店自提，适合线下有许多门店的零售企业。这种方式
在很多水果生鲜店应用很多，比如盒马鲜生。随着新零售模式的逐步开
展，门店自提的方式会越来越普遍，比如2016年双11时，天猫尝试的门
店自提效果就很不错，如图7-1所示是优衣库天猫店购物选择门店自提时
的门店列表。

取货模式:
快递自提点
自提柜
快递+便利店

最后一公里问题

运费:
用户在前台看到的运费与实际运费有着较大的区别。电商在收取运
费时会考虑将商品利润拿出来补贴用户运费，所以经常有包邮、满X元
免运费、运费一口价等运费方案，或根据距离、重量收取。前端收取运
费时，一是要核算成本；二是尽量简单，能使消费者清晰理解，过于复
杂的收费方式会增加运营成本，阻碍用户。
实际运费和向顾客收取的运费有所区别。在各地有多个仓库的自营
电商，每个仓库和当地物流服务商都会谈判确定一个服务价格，不同物
流公司在同一地区的报价也会不同，所以调度系统在选择出货仓库时，
除了要考虑库存、发货距离、配送时效，还要考虑物流成本。这就需要
后台录入和仓库对应的各物流公司的物流成本，变量有收发货地区、价
格（首重、续重），或某些特殊品类的物流成本。更智能的做法是，通
过计算各物流公司的实际配送数据，动态去调整物流公司选择的各参数
（时效、成本、距离等）的权重。


前端运费是通过运费模板来判断的。
【运费模板】
1）店铺运费模式：整个店铺采用统一的运费标准，可设置收取
固定费用，支持不同区域设置不同的运费标准。例如收取固定运费10
元；或者满X元包邮，不足X元统一收取10元。
（2）单品运费模式：为店铺内的每个商品设置单独运费，每个商
品的运费独立计算，当一个订单包含多个不同商品时，可以选择“运费
叠加”或“取最大运费值”两种运费计算方法之一。
（3）混合模式（店铺运费与单品运费同时生效模式）：店铺运费
模板与单品运费模板同时生效，店铺运费优先判断。










后端物流管理:
成本计算:
还有一个和后端物流相关的环节——对账。我们按照物流公司的规
则以及商品的体积、重量计算了一套运费，物流公司根据实际包裹也会
出一份运费结果来向我们收费。这就需要提供运费对账的功能，除了对
单据，还要比对运费是否有差距，是否在允许的误差内。除了财务对
账，据此还能排查出漏发、多发的异常情况。

================
7.4 物流单号和状态管理
================
目前常见的物流单号来源于如下几种。
（1）从菜鸟接口获取。获取时需传输收件和发件信息，菜鸟接口
反馈物流单号。主要是阿里平台（淘宝、天猫），系统会自动获取物流
状态。
（2）预先从物流公司购买号段，导入系统，使用时直接获取。物
流状态通过单号去快递100查询，保存在数据库中。
（3）自营物流，自己生产物流单号，更新物流状态。
在管理物流单号时，应及时将单号从“未使用”状态变更为“已使
用”，而当中途取消出库后，还要回收单号。一般WMS中都有打印物流
单（按照固定模板）的功能，物流公司只需要扫描识别信息即可，不用
物流公司另外打单。
订单物流发出去了，就涉及给用户反馈物流状态。当订单出库后，
反馈物流单号给客户，并且实时更新物流状态，有时候还会将仓库的操
作状态融入到物流状态中，如下发至仓库、打单、拣货、复核、出库
等。
通过各类物流查询接口，实时获取订单的配送情况，还可以定期把
这些数据格式化后化存储在系统中，后续可以根据这些对快递进行KPI
考核。有了订单的详细配送情况信息，就可以对快递公司的各项KPI指
标进行低成本的量化。
一般物流状态的查询接口都有快件是否被签收的字段，根据这个字
段，可以做订单的自动收货功能。例如签收10天后，若用户未确认收
货，自动确认收货。





============
采购系统
============
采购系统主要包括供应商管理、采购商品管理、采购订单
管理、仓库库存管理、采购预警等五个方面的业务处理。采购系统为相
关系统如仓库管理、库存中心、商品中心、财务系统等提供了有效资
料。

在大型的供应链管理系统中，采购系统还需要和上下游的系统进行
打通。目前大部分电商的采购系统仅在企业内部流通，在实际采购时走
线下流程，做得完善些的会为供应商提供后台查看、确认采购订单。采
购业务的正确执行，对缩短订货提前期、降低库存水平、节约成本、保
证正常售卖和活动促销、提高服务水准等方面，都有重要的意义。




============
8.2 供应商管理
============
（1）自采自卖：平台从供应商那里采购商品，入库到自己的仓库
进行售卖，这些商品的所有权属于平台。这是目前大部分电商采用的模
式。
（2）一件代发：主要指商品平台销售出去之后，由供应商代发，
按订单结算商品和物流费用，这种模式兴起于淘宝平台，很多小卖家无
力自备库存，而选择该模式还能减少库存资金占用。该模式的缺点是对
货源掌控力度差，销售末端服务较差。

还有一种不常见的，但是笔者很看好的模式，相信在未来会有越来
越多企业采用。笔者先暂且称呼其为“多货主仓库模式”，平台将仓库开
放给供应商使用，当供应商的商品入库时，它的商品所有权属于供应
商。对于平台和供应商来说，独占、锁定、共享库存这几种形态都可以
存在。当平台向供应商发起采购后，将相应商品的货主进行变更就行。
库存共享时，当顾客订单下发至仓库时，向供应商发起采购订单，快速
处理之后，从供应商库位拣选相关商品，变更商品货主，后面按照采购
订单，定期与供应商结算就行。

这种模式不仅解决了采购引发的库存资金占用问题，对销售末端的
管控力也增强，还可以充分利用仓储能力，并适当赚取相关的物流费
用。对于供应商来说，这种互利互惠的关系可以帮助供应商增强仓库战
略布局，不需要重新建仓，直接利用平台的仓储能力就能迅速在全国布
局。随着京东、顺丰、菜鸟逐步开放仓储能力，这种模式会越来越常
见，并且成为未来的主流模式。


===============
8.4 采购订单管理
===============
（1）采购申请是指当业务部门或供应链根据需求预测，需要进行
采购。在采购系统中录入采购计划，提请相关人员审批。
（2）采购询价是指采购申请审批通过后，由采购员根据采购申请
制作采购询价单给相应的供应商，采购询价的对象可多选。询价单发送
给供应商之后，供应商反馈报价给采购员（可做进系统流程中，供应商
在供应商系统中查看询价单，反馈报价）
流程图（图8-3）中将采购询价用虚线圈起来，是由于在许多电商企
业中，有两种处理方式：定期协议价或线下询价，很少将这一流程做到
线上的。定期协议价是指与供应商签订采购协议合同，约定SKU的采购
价格及有效期。例如企业与A供应商约定2017年～2018年SKU678765的
协议价为85元，最低采购量为100件，那么就不要走询价流程，直接进
行采购就行。
（3）采购单是确定供应商与采购价格之后，采购员在系统中录入
采购单详情，正式发起采购。供应商在供应商系统中收到相应的订单
后，安排发货事宜，反馈预计到货时间，同时生成采购入库单下发相应
的仓库。
（4）到货结算指当采购入库后，确认采购单到货，流转至财务进
行结算。

================
仓库管理系统 Warehouse Management System
================
是通过出库、入库、库位调拨、库存调拨等功能，综合批次管理、物料对
应、库存盘点、质检管理和即时库存管理等功能综合运用的管理系统，
有效控制并跟踪仓库业务的物流和成本管理全过程

===============
9.1 仓库管理概述
===============
1）WMS与采购系统，主要是采购入库单与仓间调拨，关系到仓库的出入库。
2）WMS与订单调度中心，主要是发货单、退/换货入库单，关系到仓库的出入库。
3）WMS与财务系统，主要是盘盈/盘亏单，关系到更新实物与账面的差异。
4）WMS与库存中心，在出入库、盘盈/盘亏之后，及时更新实物库存的变动。

===============
9.2 出库
===============
锁定库存的原则是先进先出，不是随机锁定的。上架商品时也是在
指定库区中由近及远，先上架最近的库位。上架和下架选择库位规则的
统一保证了先进先出的可能性。例如M商品在A01-01-03、A02-01-06、
A05-01-02等3个库位存放，上架时选择库位的顺序就是从A01-01-03到
A02-01-06，再到A05-01-02。在锁定库位时，先锁定A01-01-03中的库
存，不够了再去锁定A02-01-06中的库存，最后是A05-01-02中的库存。

如果在预调度时，拣货区库存不足，就生成相应的补货需求。

在预调度之后，生成拣货波次。拣货波次是指将几个订单合并拣
货，可以提高拣货效率。

拣货路径的算法在拣货时也至关重要，主要是缩短拣货员的拣货距离。
那么就将该拣货顺序推荐给拣货员，应尽量避免让拣货员去思考。

【复核】
复核主要是对拣货完成的订单进行核对，保证发货单、实物商品、
物流单的统一。扫描发货单上的仓库单号条码，定位到相应的订单，再
去扫描商品条码，保证商品和数量无误，最后扫描物流单，校验发货
单、实物商品、物流单三者完全一致时，视为复核完成。


【包装】
复核后对订单的商品进行打包，然后称重。从WMS系统的角度上
说，此举主要是对包裹进行称重或体积录入，甚至拍照存档。可以根据
重量、体积参数等检查是否错发漏发。在与物流公司对账时也有相关依
据。

==============
9.3 入库
==============



【商品上架】
商品上架不仅包括商品入库上架，还包括补货上架、移库上架、返
库上架等情形。上架就涉及库位的选择，入库上架、补货上架会优先选
择同一供应商同一SKU的库位，若没有再选择空库位。返库上架会优先
选择回到原库位。在PDA上生成相应的上架任务，员工按照PDA将商品
上架到相应的库位上，首先扫描库位码，然后商品条码，最后确认数
量。上架后更新库位库存信息。




















